<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pradeep's Timetable with Current Task</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f4f4;
      color: #333;
      padding: 20px;
    }
    h1, h2 {
      text-align: center;
      color: #005f73;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: left;
    }
    th {
      background-color: #0a9396;
      color: white;
    }
    tr:nth-child(even) {
      background-color: #e0fbfc;
    }
    .highlight {
      background-color: #ffd166 !important;
    }
  </style>
</head>
<body>
  <h1>Pradeep's Daily Timetable</h1>
  <div id="current-task"></div>
  <div id="timetable"></div>

  <script>
    const subjects = ["VLSI", "Embedded Systems", "Game Design", "Web Development", "Java"];
    const baseSchedule = [
      ["5:00 AM - 5:30 AM", "Wake up + Freshen up"],
      ["5:30 AM - 6:00 AM", "Workout / Exercise"],
      ["6:00 AM - 6:30 AM", "Breakfast"],
      ["6:30 AM - 8:00 AM", ""],
      ["8:00 AM - 9:30 AM", ""],
      ["9:30 AM - 9:45 AM", "Short Break (snack/stretch)"],
      ["9:45 AM - 11:15 AM", ""],
      ["11:15 AM - 12:15 PM", "Lunch + Short Rest"],
      ["12:15 PM - 1:45 PM", ""],
      ["1:45 PM - 2:00 PM", "Tea/Water break"],
      ["2:00 PM - 3:30 PM", ""],
      ["3:30 PM - 4:30 PM", "Personal time / Power Nap"],
      ["4:30 PM - 6:00 PM", "Practice / Projects / Revision"],
      ["6:00 PM - 7:00 PM", "Dinner + Chill time"],
      ["7:00 PM - 8:30 PM", "Light study / Notes / Review"],
      ["8:30 PM - 9:00 PM", "Wind down + Phone off"],
      ["9:00 PM - 5:00 AM", "Sleep"]
    ];

    // Get today's shuffled subjects
    const today = new Date();
    const jsDay = today.getDay(); // Sunday = 0
    const subjectIndex = (jsDay === 0 || jsDay === 6) ? 0 : (jsDay - 1) % 5;
    const rotatedSubjects = subjects.slice(subjectIndex).concat(subjects.slice(0, subjectIndex));

    // Assign study subjects to the correct time slots
    const studyTimes = [3, 4, 6, 8, 10]; // indices where study slots are
    for (let i = 0; i < 5; i++) {
      baseSchedule[studyTimes[i]][1] = `Study: ${rotatedSubjects[i]}`;
    }

    // Convert time string to minutes
    function timeToMinutes(str) {
      const [start, end] = str.split(" - ");
      const convert = (s) => {
        const [t, p] = s.split(" ");
        let [h, m] = t.split(":").map(Number);
        if (p === "PM" && h !== 12) h += 12;
        if (p === "AM" && h === 12) h = 0;
        return h * 60 + m;
      };
      return [convert(start), convert(end)];
    }

    const now = new Date();
    const nowMinutes = now.getHours() * 60 + now.getMinutes();

    let currentSlotIndex = -1;
    baseSchedule.forEach(([range], i) => {
      const [start, end] = timeToMinutes(range);
      if (nowMinutes >= start && nowMinutes < end) {
        currentSlotIndex = i;
      }
    });

    // Show current task
    if (currentSlotIndex !== -1) {
      document.getElementById("current-task").innerHTML = `
        <h2>ðŸ”” Current Task</h2>
        <table>
          <tr><th>Time</th><th>Activity</th></tr>
          <tr class="highlight">
            <td>${baseSchedule[currentSlotIndex][0]}</td>
            <td>${baseSchedule[currentSlotIndex][1]}</td>
          </tr>
        </table>
      `;
    } else {
      document.getElementById("current-task").innerHTML = `
        <h2>ðŸ”” Current Task</h2>
        <p style="text-align:center;">ðŸŽ‰ You're off the clock now or it's between tasks.</p>
      `;
    }

    // Show full day plan
    let fullTable = `<h2>ðŸ“‹ Full Day Plan</h2><table><tr><th>Time</th><th>Activity</th></tr>`;
    baseSchedule.forEach(([time, task], i) => {
      fullTable += `
        <tr ${i === currentSlotIndex ? 'class="highlight"' : ''}>
          <td>${time}</td><td>${task}</td>
        </tr>
      `;
    });
    fullTable += "</table>";
    document.getElementById("timetable").innerHTML = fullTable;
  </script>
</body>
</html>
